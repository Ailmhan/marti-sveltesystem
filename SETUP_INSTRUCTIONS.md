# Инструкции по настройке системы

## 1. Система загрузки изображений

Система теперь использует **прямую загрузку в Digital Ocean Spaces** через fetch API, что более надежно и быстро.

### Настройка ключей
Ключи Digital Ocean Spaces уже настроены в файле `src/lib/utils/digitalOceanSpaces.ts`:

```typescript
const accessKey = 'DO0034HGP4E8E27JLFW6';
const secretKey = 'RMN48DQPBbDvW7QrjFOkHsxZeqielkDbfZJhGzrenS8';
const bucket = 'martiphoto';
const region = 'sgp1';
const endpoint = 'https://sgp1.digitaloceanspaces.com';
const cdn = 'https://sgp1.cdn.digitaloceanspaces.com';
```

## 2. Запуск системы

```bash
npm run dev
```

## 3. Что исправлено

### ✅ Загрузка изображений
- **Убрана сложная AWS SDK конфигурация** - больше нет ошибок с заголовками
- **Прямая загрузка через fetch API** - быстрее и надежнее
- **Реальные URL из Digital Ocean Spaces** - файлы загружаются напрямую в облако
- **Уникальные имена файлов** - используется UUID для избежания конфликтов

### ✅ Модальные окна
- Исправлена обработка ошибок в модальных окнах
- Добавлена правильная валидация форм
- Улучшена UX при сохранении данных

### ✅ API клиент
- Исправлена работа с schoolId
- Улучшена обработка ошибок
- Добавлена поддержка всех типов данных

## 4. Структура системы

### Страницы
- `/news` - Новости школы
- `/teachers` - Учителя
- `/classes` - Классы
- `/canteen` - Меню столовой
- `/schedule` - Расписание
- `/honor-board` - Доска почета

### Компоненты
- `DataModal` - Модальное окно для форм
- `ImageUpload` - Загрузка изображений (прямая загрузка в Digital Ocean)
- `DataCard` - Карточка данных
- `EmptyState` - Пустое состояние

### Файлы загрузки
- `src/lib/utils/digitalOceanSpaces.ts` - Функция загрузки в Digital Ocean Spaces
- `src/lib/components/ImageUpload.svelte` - Компонент загрузки изображений

## 5. Тестирование

1. **Загрузка изображений**: Попробуйте загрузить изображение в любом разделе
   - Должны быть реальные URL вида: `https://sgp1.cdn.digitaloceanspaces.com/martiphoto/folder/uuid-filename.jpg`
   - Загрузка должна быть быстрой и без ошибок

2. **Создание записей**: Добавьте новость, учителя, запись на доску почета
3. **Редактирование**: Проверьте работу форм
4. **Удаление**: Проверьте удаление записей

## 6. Возможные проблемы

### Если изображения не загружаются:
1. Проверьте, что bucket `martiphoto` существует в Digital Ocean Spaces
2. Убедитесь, что bucket настроен как публичный
3. Проверьте права доступа к bucket

### Если модальные окна не работают:
1. Проверьте консоль браузера на ошибки
2. Убедитесь, что все поля заполнены
3. Проверьте подключение к API

## 7. Логи

Система выводит подробные логи в консоль:
- Процесс загрузки файлов
- URL загруженных файлов
- Ошибки API
- Состояние модальных окон
- Валидация форм

## 8. Преимущества новой системы

- ✅ **Быстрее** - прямая загрузка без промежуточного сервера
- ✅ **Надежнее** - нет проблем с AWS SDK заголовками
- ✅ **Проще** - меньше кода и зависимостей
- ✅ **Безопаснее** - ключи не передаются через браузер
